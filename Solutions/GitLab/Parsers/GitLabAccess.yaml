id: 71370b00-ae18-4104-88ef-f79ca13c90fb
Function:
  Title: Parser for GitLabAccess
  Version: '1.0.0'
  LastUpdated: '2023-08-22'
Category: Microsoft Sentinel Parser
FunctionName: GitLabAccess
FunctionAlias: GitLabAccess
FunctionQuery: |
    Syslog
    | where Facility == 'local7'
    | where ProcessName == 'GitLab-Access-Logs'
    | where SyslogMessage has_any ("GET","POST","PUT","DELETE","PATCH") and SyslogMessage contains "HTTP"
    | parse SyslogMessage with IPAddress " - - [" EventTime "] \"" RequestVerb " " URI " " HTTPVersion "\"" ResponseCode " " BytesSent "\"" HTTPReferer "\" \"" UserAgent
    | project TimeGenerated, EventTime = todatetime(EventTime), IPAddress, RequestVerb, URI, HTTPVersion, ResponseCode, BytesSent, HTTPReferer, UserAgent