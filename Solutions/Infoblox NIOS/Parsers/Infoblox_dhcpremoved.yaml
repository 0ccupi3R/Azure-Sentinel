id: c59f4b28-e35f-4f7e-b2cb-aba296b3fbd4
Function:
  Title: Parser for Infoblox_dhcpremoved
  Version: '1.0.0'
  LastUpdated: '2023-08-22'
Category: Microsoft Sentinel Parser
FunctionName: Infoblox_dhcpremoved
FunctionAlias: Infoblox_dhcpremoved
FunctionQuery: |
    let datasource = (_GetWatchlist('Sources_by_SourceType')| where SearchKey == 'InfobloxNIOS' | project Source);
    let RawData = Syslog
        | where Computer in (datasource)
        | where SyslogMessage has "Removed"
        | extend Parser = extract_all(@"^(\d{2}\-[a-zA-Z]{3}\-\d{4}\s[0-9\.\:]+)?\s?([a-zA-Z-_]+)(\s|\:)?(.*)", dynamic([1,2,3,4]), SyslogMessage)[0]
        | extend responseTime = todatetime(Parser[0]),
                 RawData_subString = tostring(Parser[3])
        | project-away Parser;
    RawData
        | extend dhcpremoved = extract_all(@"([\w\s]+)(from|on)\s(\S+)(\sto\s(\S+))?", dynamic([1,2,3,4,5]), RawData_subString)[0]
        | extend Log_Type = strcat(Type," ",tostring(dhcpremoved[0])),
            SrcHostname = tostring(dhcpremoved[2]),  
            DvcHostname = tostring(dhcpremoved[4])
        | project-away SyslogMessage, dhcpremoved, RawData_subString;