id: 5470acf6-44fc-4c06-9887-949c19527309
name: Dataminr - alert enrichment using ASIM Web Session
description: |
  'Rule helps to generate an incident which execute the Dataminr Pulse Alert Enrichment workflow when new data is available in ASIM Web Session.'
severity: Medium
status: Available
requiredDataConnectors:
  - connectorId: DataminrPulseAlerts
    dataTypes:
      - ASimWebSession
queryFrequency: 5m
queryPeriod: 5m
triggerOperator: GreaterThan
triggerThreshold: 0
tactics: 
  - Execution
relevantTechniques:
  - T1053
query: |
  ASimWebSession
  |where isnotempty(Url)
      or isnotempty(Hostname)
      or isnotempty(FileMD5)
      or isnotempty(FileSHA1)
      or isnotempty(FileSHA256)
      or isnotempty(FileSHA512)
incidentConfiguration:
  createIncident: true
eventGroupingSettings:
  aggregationKind: AlertPerResult
customDetails:
  Url: Url
  FileMD5: FileMD5
  FileSHA1: FileSHA1
  FileSHA256: FileSHA256
  FileSHA512: FileSHA512
  Hostname: Hostname
entityMappings:
  - entityType: FileHash
    fieldMappings:
      - identifier: Value
        columnName: FileMD5
  - entityType: Host
    fieldMappings:
      - identifier: HostName
        columnName: Hostname
  - entityType: URL
    fieldMappings:
      - identifier: Url
        columnName: Url
version: 1.0.0
kind: Scheduled