id: e0a69f96-e404-4d05-aceb-621d611a0a62
name: Dataminr - alert enrichment using ASIM Dns
description: |
  'Rule helps to generate an incident which execute the Dataminr Pulse Alert Enrichment workflow when new data is available in ASIM Dns.'
severity: Medium
status: Available
requiredDataConnectors:
  - connectorId: DataminrPulseAlerts
    dataTypes:
      - ASimDns
queryFrequency: 5m
queryPeriod: 5m
triggerOperator: GreaterThan
triggerThreshold: 0
tactics: 
  - Execution
relevantTechniques:
  - T1053
query: |
  ASimDns
  | where isnotempty(SrcIpAddr)
      or isnotempty(DstIpAddr)
      or isnotempty(SrcHostname)
      or isnotempty(DstHostname)
      or isnotempty(SrcDomain)
      or isnotempty(DstDomain)
incidentConfiguration:
  createIncident: true
eventGroupingSettings:
  aggregationKind: AlertPerResult
customDetails:
  SrcIpAddr: SrcIpAddr
  DstIpAddr: DstIpAddr
  SrcHostname: SrcHostname
  DstHostname: DstHostname
  SrcDomain: SrcDomain
  DstDomain: DstDomain
entityMappings:
  - entityType: IP
    fieldMappings:
      - identifier: Address
        columnName: SrcIpAddr
  - entityType: DNS
    fieldMappings:
      - identifier: DomainName
        columnName: SrcDomain
version: 1.0.0
kind: Scheduled