id: aec43411-61b4-49be-aa00-7b796b158dcf
name: Dataminr - alert enrichment using ASIM Network Session
description: |
  'Rule helps to generate an incident which execute the Dataminr Pulse Alert Enrichment workflow when new data is available in ASIM Network Session.'
severity: Medium
status: Available
requiredDataConnectors:
  - connectorId: DataminrPulseAlerts
    dataTypes:
      - ASimNetworkSession
queryFrequency: 5m
queryPeriod: 5m
triggerOperator: GreaterThan
triggerThreshold: 0
tactics: 
  - Execution
relevantTechniques:
  - T1053
query: |
  ASimNetworkSession
  | where isnotempty(SrcIpAddr)
      or isnotempty(DstIpAddr)
      or isnotempty(SrcHostname)
      or isnotempty(DstHostname)
      or isnotempty(SrcDomain)
      or isnotempty(DstDomain)
      or isnotempty(SrcMacAddr)
      or isnotempty(DstMacAddr)
      or isnotempty(SrcNatIpAddr)
      or isnotempty(DstNatIpAddr)
incidentConfiguration:
  createIncident: true
eventGroupingSettings:
  aggregationKind: AlertPerResult
customDetails:
  SrcIpAddr: SrcIpAddr
  DstIpAddr: DstIpAddr
  SrcHostname: SrcHostname
  DstHostname: DstHostname
  SrcDomain: SrcDomain
  DstDomain: DstDomain
  SrcMacAddr: SrcMacAddr
  DstMacAddr: DstMacAddr
  SrcNatIpAddr: SrcNatIpAddr
  DstNatIpAddr: DstIpAddr
entityMappings:
  - entityType: IP
    fieldMappings:
      - identifier: Address
        columnName: SrcIpAddr
  - entityType: Host
    fieldMappings:
      - identifier: HostName
        columnName: SrcHostname
version: 1.0.0
kind: Scheduled