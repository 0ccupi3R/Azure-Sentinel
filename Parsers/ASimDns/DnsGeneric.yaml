Parser:
  Title: Generic DnsEvents
  Version: '0.1'
  LastUpdated: May 11, 2021
Product:
  Name: Multiple
Normalization:
  Schema: DnsEvents
  Version: '1.0.0'
References:
- Title: Using functions
  Link: https://docs.microsoft.com/azure/azure-monitor/log-query/function
- Title: Dns schema documentation
  Link: https://aka.ms/AzSentinelDnsDoc
Description: |
  TODO
ParserName: imDns
ParserParams:
  - Name: starttime
    Type: datetime
  - Name: endtime
    Type: datetime
  - Name: srcipaddr
    Type: string
  - Name: domain
    Type: string
  - Name: responsecodename
    Type: string
  - Name: response
    Type: string
  - Name: eventtype
    Type: string
ParserQuery: |
  let DnsGeneric=(starttime:datetime=datetime(null), endtime:datetime=datetime(null), srcipaddr:string='*',domain:string='*', responsecodename:string='*', response:string='*', eventtype:string='lookup'){
  union isfuzzy=true
    vimDnsEmpty
    , vimDnsCiscoUmbrella(starttime, endtime, srcipaddr,domain, responsecodename, response, eventtype)
    , vimDnsInfobloxNIOS(starttime, endtime, srcipaddr,domain, responsecodename, response, eventtype)
    , vimDnsMicrosoftOMS(starttime, endtime, srcipaddr,domain, responsecodename, response, eventtype)
  };
  DnsGeneric(starttime, endtime, srcipaddr,domain, responsecodename, response, eventtype)